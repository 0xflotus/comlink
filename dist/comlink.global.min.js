'use strict';self.Comlink=function(){function a(b){if(k(b)&&(b=e(b)),!f(b))throw Error('endpoint does not have all of addEventListener, removeEventListener and postMessage defined');return g(b),n(async(d)=>{let e=[];('APPLY'===d.type||'CONSTRUCT'===d.type)&&(e=d.argumentsList.map((a)=>{if(r(a)){const{port1:b,port2:d}=new MessageChannel;return c(a,b),{type:'PROXY',endpoint:d}}if(s(a)){const{port1:b,port2:d}=new MessageChannel;return c(a,b),{type:'EVENTLISTENER',endpoint:d}}return{type:'RAW',value:a}}));const f=await l(b,Object.assign({},d,{argumentsList:e}),q(e)),g=f.data;if('ERROR'===g.type)throw Error(g.error);return'PROXY'===g.type?a(g.endpoint):g.obj})}function b(a){return a[x]=!0,a}function c(c,i){if(k(i)&&(i=e(i)),!f(i))throw Error('endpoint does not have all of addEventListener, removeEventListener and postMessage defined');g(i),h(i,async function(e){if(!e.data.id)return;const f=e.data;let g=await f.callPath.slice(0,-1).reduce((a,b)=>a[b],c),h=await f.callPath.reduce((a,b)=>a[b],c);const j=h&&'AsyncGeneratorFunction'===h.constructor.name;let k,l=h,m=[];if(('APPLY'===f.type||'CONSTRUCT'===f.type)&&(m=f.argumentsList.map((b)=>{if('PROXY'===b.type)return a(b.endpoint);if('EVENTLISTENER'===b.type){const c=a(b.endpoint);return(a)=>c(d(a))}if('RAW'===b.type)return b.value;throw Error('Unknown type')})),'APPLY'===f.type)try{l=await h.apply(g,m)}catch(a){k=a}if(j&&(l=b(l)),'CONSTRUCT'===f.type)try{l=new h(...(m||[])),l=b(l)}catch(a){k=a}return'SET'===f.type&&(h[f.property]=f.value,l=!0),l=t(l,k),l.id=f.id,i.postMessage(l,q([l]))})}function d(a){return{targetId:a.target&&a.target.id,targetClassList:a.target&&a.target.classList,detail:a.detail}}function e(a){if('Window'!==self.constructor.name)throw Error('self is not a window');return{addEventListener:self.addEventListener.bind(self),removeEventListener:self.removeEventListener.bind(self),postMessage:(b,c)=>a.postMessage(b,'*',c)}}function f(a){return'addEventListener'in a&&'removeEventListener'in a&&'postMessage'in a}function g(a){j(a)&&a.start()}function h(a,b){a.addEventListener('message',b)}function i(a,b){a.removeEventListener('message',b)}function j(a){return'MessagePort'===a.constructor.name}function k(a){return['window','length','location','parent','opener'].every((b)=>b in a)}function l(a,b,c){const d=`${u}-${v++}`;return new Promise((e)=>{h(a,function b(c){c.data.id!==d||(i(a,b),e(c))}),b=Object.assign({},b,{id:d}),a.postMessage(b,c)})}function m(){return'asyncIterator'in Symbol}function n(a){let b=[];return new Proxy(function(){},{construct(c,d){const e=a({type:'CONSTRUCT',callPath:b,argumentsList:d});return b=[],e},apply(c,d,e){if('bind'===b[b.length-1]){const c=b.slice();return b=[],(...b)=>a({type:'APPLY',callPath:c.slice(0,-1),argumentsList:b})}const f=a({type:'APPLY',callPath:b,argumentsList:e});return b=[],f},get(c,d,e){if('then'===d&&0===b.length)return{then:()=>e};if(m()&&d===Symbol.asyncIterator)return()=>e;if('then'===d){const c=a({type:'GET',callPath:b});return b=[],Promise.resolve(c).then.bind(c)}return b.push(d),e},set(c,d,e){return a({type:'SET',callPath:b,property:d,value:e})}})}function o(a){return w.some((b)=>a instanceof b)}function*p(a){if(!a)return;if('string'==typeof a)return;yield a;let b=Object.values(a);Array.isArray(a)&&(b=a);for(const c of b)yield*p(c)}function q(a){const b=[];for(const c of p(a))o(c)&&b.push(c);return b}function r(a){return a&&a[x]}function s(a){return a&&a[y]}function t(a,b=null){if(b)return{type:'ERROR',error:'stack'in b?b.stack:b.toString()};if(r(a)){const{port1:b,port2:d}=new MessageChannel;return c(a,b),{type:'PROXY',endpoint:d}}return{type:'OBJECT',obj:a}}const u=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER);let v=0;const w=[ArrayBuffer,MessagePort],x=Symbol('proxyValue'),y=Symbol('eventListener');return{proxy:a,proxyValue:b,eventListener:function(a){return a[y]=!0,(b)=>a(d(b))},expose:c}}();
